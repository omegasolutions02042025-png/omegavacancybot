# --- ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ ---

import inspect
from collections import namedtuple
if not hasattr(inspect, "getargspec"):
    ArgSpec = namedtuple('ArgSpec', ['args', 'varargs', 'keywords', 'defaults'])
    def getargspec(func):
        spec = inspect.getfullargspec(func)
        return ArgSpec(
            args=spec.args,
            varargs=spec.varargs,
            keywords=spec.varkw,
            defaults=spec.defaults,
        )
    inspect.getargspec = getargspec

import re

async def update_channels_and_restart_handler(new_channels, CHANNELS, register_handler):
    """ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº ÐºÐ°Ð½Ð°Ð»Ð¾Ð² Ð¸ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº"""
    CHANNELS.clear()
    CHANNELS.extend(new_channels)
    await register_handler()



def is_russia_only_citizenship(text: str) -> bool:
    """
    ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð³Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÑ‚Ð²Ð¾ ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¿Ð¾ÑÐ»Ðµ ÑÐ»Ð¾Ð²Ð° 'Ð“Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÑ‚Ð²Ð¾'.
    ÐžÐ¢Ð¡Ð•ÐšÐÐ•Ð¢, ÐµÑÐ»Ð¸ ÑƒÐºÐ°Ð·Ð°Ð½Ð¾ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð Ð¾ÑÑÐ¸Ñ/Ð Ð¤ Ð±ÐµÐ· ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð Ð‘.
    ÐŸÐ ÐžÐ¥ÐžÐ”Ð˜Ð¢, ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð Ð‘ Ð²Ð¼ÐµÑÑ‚Ðµ Ñ Ð Ð¤.
    """
    # Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ Ð´Ð»Ñ Ð¾Ñ‚ÑÐµÑ‡ÐµÐ½Ð¸Ñ Ð Ð¤
    russia_only_patterns = [
        r"\bÑ€Ñ„\b",
        r"\bÑ€Ð¾ÑÑÐ¸Ñ\b",
        r"Ñ‚Ð¾Ð»ÑŒÐºÐ¾\s*Ñ€Ñ„",
        r"Ñ‚Ð¾Ð»ÑŒÐºÐ¾\s*Ñ€Ð¾ÑÑÐ¸Ñ",
        r"Ñ‚Ð¾Ð»ÑŒÐºÐ¾\s*Ð³Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÑ‚Ð²Ð¾\s*Ñ€Ñ„",
        r"Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚\s*Ñ€Ñ„\s*Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½",
        r"Ñ‚Ð¾Ð»ÑŒÐºÐ¾\s*Ñ€Ð¾ÑÑÐ¸ÑÐ½Ðµ",
        r"Ñ‚Ð¾Ð»ÑŒÐºÐ¾\s*Ð³Ñ€Ð°Ð¶Ð´Ð°Ð½Ðµ\s*Ñ€Ñ„",
        r"Ð½Ð°Ð»Ð¾Ð³Ð¾Ð²Ð¾Ðµ\s*Ñ€ÐµÐ·Ð¸Ð´ÐµÐ½Ñ‚ÑÑ‚Ð²Ð¾\s*Ñ€Ñ„\s*Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾",
        r"Ð¸Ð·\s*Ñ€Ñ„",
        r"Ð¶Ð¸Ñ‚ÐµÐ»Ð¸\s*Ñ€Ñ„",
        r"Ñ€Ð°Ð±Ð¾Ñ‚Ð°\s*Ð¸Ð·\s*Ð»ÑŽÐ±Ð¾Ð¹\s*Ñ‚Ð¾Ñ‡ÐºÐ¸\s*Ñ€Ñ„",
        r"Ð»Ð¾Ðº:\s*Ñ€Ñ„",
        r"Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ\s*Ð²\s*Ñ€Ñ„"
    ]

    # Ð˜Ñ‰ÐµÐ¼ ÑÑ‚Ñ€Ð¾ÐºÑƒ Ð¿Ð¾ÑÐ»Ðµ ÑÐ»Ð¾Ð²Ð° "Ð“Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÑ‚Ð²Ð¾"
    match = re.search(r"Ð“Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÑ‚Ð²Ð¾\s*[:\-]?\s*(.+)", text, flags=re.IGNORECASE)
    if match:
        citizenship = match.group(1).lower()
        # Ð•ÑÐ»Ð¸ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ â€” ÐÐ• Ð¾Ñ‚ÑÐµÐºÐ°Ñ‚ÑŒ
        if "Ñ€Ð±" in citizenship or "Ð±ÐµÐ»Ð°Ñ€ÑƒÑÑŒ" in citizenship:
            return False
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²ÑÐµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ Ð Ð¤
        for pattern in russia_only_patterns:
            if re.search(pattern, citizenship):
                return True
    return False



import pymorphy2

def oplata_filter(text: str) -> bool:
    morph = pymorphy2.MorphAnalyzer()
    filters_raw = [
        "Ð°ÐºÑ‚Ñ‹ Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾", "ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ",
        "Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ð°", "Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ",
        "Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾", "ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ð°", "Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð°Ñ"
    ]

    # Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·ÑƒÐµÐ¼ Ñ‚ÐµÐºÑÑ‚
    normal_text_words = [morph.parse(w)[0].normal_form for w in text.lower().split()]
    normal_text = " ".join(normal_text_words)

    # Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐºÐ°Ð¶Ð´ÑƒÑŽ Ñ„Ñ€Ð°Ð·Ñƒ
    for phrase in filters_raw:
        normal_phrase = " ".join(morph.parse(w)[0].normal_form for w in phrase.lower().split())
        if normal_phrase in normal_text:
            return True
    return False


# ÐŸÑ€Ð¸Ð¼ÐµÑ€
examples = [
    "ÐÑƒÐ¶Ð½Ð¾ Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² Ð¿Ð¾ ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»Ð°Ð¼",       # True
    "ÐŸÑ€Ð¾Ð¸Ð·Ð²ÐµÐ»Ð¸ Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð¾Ð¿Ð»Ð°Ñ‚Ñƒ",                 # True
    "ÐÐºÑ‚Ñ‹ Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹",                   # True
    "ÐŸÑ€Ð¾ÑÑ‚Ð¾ ÐµÐ¶ÐµÐ¼ÐµÑÑÑ‡Ð½Ð°Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ð°",
    'ÐŸÐ¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ð°',
    'ÐÐºÑ‚Ñ‹ Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾',
    '''
ðŸ†”8629

ðŸ¥‡ Frontend

Ðž ÐºÐ°Ð½Ð´Ð¸Ð´Ð°Ñ‚Ðµ:
Ð¡Ñ‚ÐµÐº: Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸
Ð“Ñ€ÐµÐ¹Ð´: Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸
ÐžÐ¿Ñ‹Ñ‚ Ð² Ð³Ð¾Ð´Ð°Ñ…: Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸
Ð›Ð¾ÐºÐ°Ñ†Ð¸Ñ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð°: Ð½Ðµ Ð²Ð°Ð¶Ð½Ð¾
Ð¢Ð°Ð¹Ð¼-Ð·Ð¾Ð½Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°: Ð¼ÑÐº
Ð“Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÑ‚Ð²Ð¾: Ð½Ðµ Ð²Ð°Ð¶Ð½Ð¾

Ðž Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ:
ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°:* Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸
ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½ÐµÑ‡Ð½Ð¾Ð³Ð¾ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° Ð¸Ð»Ð¸ Ð¾Ñ‚Ñ€Ð°ÑÐ»ÑŒ: Ñ€Ð¸Ñ‚ÐµÐ¹Ð»
Ð”Ð°Ñ‚Ð° ÑÑ‚Ð°Ñ€Ñ‚Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°: ASAP 
ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° (Ð¾Ñ‚ 3Ñ… Ð¼ÐµÑÑÑ†ÐµÐ²): Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹

ÐžÑ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ:
Ð¢Ð¸Ð¿ Ð·Ð°Ð½ÑÑ‚Ð¾ÑÑ‚Ð¸: ÑƒÐ´Ð°Ð»Ñ‘Ð½ÐºÐ°
Ð¡Ñ‚Ð°Ð²ÐºÐ° Ð·Ð°ÐºÑƒÐ¿ÐºÐ¸: ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ Ð²Ð°ÑˆÑƒ
Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°: Ñ„ÑƒÐ»Ð»-Ñ‚Ð°Ð¹Ð¼ 
Ð£ÑÐ»Ð¾Ð²Ð¸Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹: Ð¿Ð¾ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð°Ñ
ÐžÑÐ¾Ð±Ñ‹Ðµ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ: -

Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¸ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ âž¡ï¸@katushar Ð¸Ð»Ð¸ Ð² Ð¾Ð±Ñ‰Ð¸Ð¹ Ñ‡Ð°Ñ‚. Ð£ÐºÐ°Ð·Ð°Ñ‚ÑŒ ðŸ†” Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°. 

â—ï¸ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ ÐºÐ°Ð½Ð´Ð¸Ð´Ð°Ñ‚Ñƒ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð´Ð°Ñ‡Ðµ: â—ï¸
â— Ð¤Ð˜
â— Ð¡Ñ‚Ñ€Ð°Ð½Ð°+Ð“Ð¾Ñ€Ð¾Ð´
â— Ð“Ñ€ÐµÐ¹Ð´
â— Ð¡Ñ‚Ð°Ð²ÐºÐ°
â— ÐžÑ†ÐµÐ½Ð¸Ñ‚ÑŒ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ Ð”Ð/ÐÐ•Ð¢, Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ñ Ð½Ð°Ð»Ð¸Ñ‡Ð¸ÐµÐ¼ Ð¾Ð¿Ñ‹Ñ‚Ð°.ï¸
â— Ð’Ð¡Ð• Ð¢Ð Ð•Ð‘ÐžÐ’ÐÐÐ˜Ð¯ Ð˜Ð— Ð—ÐÐŸÐ ÐžÐ¡Ð ÐžÐ¢Ð ÐÐ–Ð•ÐÐ« Ð’ ÐŸÐ ÐžÐ•ÐšÐ¢ÐÐ¥ Ð Ð•Ð—Ð®ÐœÐ•

ðŸ’» Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ: 
Frontend-Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ñ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ñ‹Ð¼ Ð²Ð»Ð°Ð´ÐµÐ½Ð¸ÐµÐ¼ JavaScript Ð¸ TypeScript, ÑÐ¾ Ð·Ð½Ð°Ð½Ð¸ÐµÐ¼ React, Hooks, React Router, React Query, Vite, HTML5, ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ CSS (Flex/Grid), CSS-Ð¼Ð¾Ð´ÑƒÐ»Ð¸.
â—ï¸â—ï¸â—ï¸ÐŸÑ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ñ‹Ðµ Ð·Ð½Ð°Ð½Ð¸Ñ Ð² Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ O365 (Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº SPFx, Active Directory, Power Automate)'''                       # False
]

for e in examples:
    print(e, "->", oplata_filter(e))
