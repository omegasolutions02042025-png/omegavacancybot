import inspect
from collections import namedtuple
from db import get_next_sequence_number
from gpt_gimini import generate_hashtags_gemini
from aiogram import Bot
from datetime import datetime
import pytz
import json
import re

if not hasattr(inspect, "getargspec"):
    ArgSpec = namedtuple('ArgSpec', ['args', 'varargs', 'keywords', 'defaults'])
    def getargspec(func):
        spec = inspect.getfullargspec(func)
        return ArgSpec(
            args=spec.args,
            varargs=spec.varargs,
            keywords=spec.varkw,
            defaults=spec.defaults,
        )
    inspect.getargspec = getargspec

# --- –û–±—ã—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ---


async def update_channels_and_restart_handler(new_channels, CHANNELS, register_handler):
    """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫"""
    CHANNELS.clear()
    CHANNELS.extend(new_channels)
    await register_handler()



def is_russia_only_citizenship(text: str) -> bool:
	"""
	–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
	- –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ: –æ—Ç—Å–µ—á—å, –µ—Å–ª–∏ —Å—Ç—Ä–æ–≥–æ –†–§/–†–æ—Å—Å–∏—è –±–µ–∑ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö/—Ä–∞–∑—Ä–µ—à–∞—é—â–∏—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫
	- –õ–æ–∫–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞: –æ—Ç—Å–µ—á—å, –µ—Å–ª–∏ —Å—Ç—Ä–æ–≥–æ –†–§/–†–æ—Å—Å–∏—è –±–µ–∑ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö/—Ä–∞–∑—Ä–µ—à–∞—é—â–∏—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫
	–û—Ç—Å–µ–∫–∞–µ–º, –µ—Å–ª–∏ –õ–Æ–ë–û–ô –∏–∑ –±–ª–æ–∫–æ–≤ —Å—Ç—Ä–æ–≥–∏–π (OR), –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –¥—Ä—É–≥–æ–º –±–ª–æ–∫–µ —É–∫–∞–∑–∞–Ω–æ "–ª—é–±–æ–π"/–¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ.
	"""
	text_lower = text.lower()

	# –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
	friendly_keywords = [
		"—Ä–±", "–±–µ–ª–∞—Ä—É—Å—å", "–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω", "–∞—Ä–º–µ–Ω–∏—è", "–∫–∏—Ä–≥–∏–∑–∏—è", "–∫—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω",
		"—É–∑–±–µ–∫–∏—Å—Ç–∞–Ω", "—Ç–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω", "–∞–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω", "—Å–µ—Ä–±–∏—è", "—Ç—É—Ä—Ü–∏—è", "—Å–Ω–≥", "–µ–∞—ç—Å",
		"—Ä—Ñ/—Ä–±", "—Ä—Ñ –∏ —Ä–±", "—Ä—Ñ –ª–∏–±–æ —Ä–±", "—Ä—Ñ, —Ä–±",
		"—Ä—Ñ/–¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ", "—Ä—Ñ / –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ", "—Ä—Ñ- –¥—Ä—É—à—Å—Ç–≤–µ–Ω–Ω—ã–µ", "—Ä—Ñ - –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ",
		"—Ä—Ñ –∏ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã", "—Ä—Ñ –ª–∏–±–æ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ", "—Ä—Ñ, –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ"
	]
	broad_allow_keywords = [
		"–ª—é–±–æ–π", "–ª—é–±–∞—è", "–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π", "any", "worldwide", "global",
		"–ª—é–±–∞—è –ª–æ–∫–∞—Ü–∏—è", "–ª—é–±–æ–π —Ä–µ–≥–∏–æ–Ω", "–±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏"
	]
	strict_russia_patterns = [
        r"—Ç–æ–ª—å–∫–æ\s*(?:—Ä—Ñ|—Ä–æ—Å—Å–∏—è)",
        r"—Ç–æ–ª—å–∫–æ\s*–≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ\s*—Ä—Ñ",
        r"–ø–∞—Å–ø–æ—Ä—Ç\s*—Ä—Ñ\s*–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω",
        r"–Ω–∞–ª–æ–≥–æ–≤–æ–µ\s*—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å—Ç–≤–æ\s*—Ä—Ñ\s*–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ",
        r"–∂–∏—Ç–µ–ª–∏\s*—Ä—Ñ",
        r"\b–∏–∑\s*—Ä—Ñ\b",
        r"\b–ª–æ–∫–∞—Ü(?:–∏—è|–∏)\s*[:\-]?\s*—Ä—Ñ\b",
        r"\b–ª–æ–∫:\s*—Ä—Ñ\b",
        r"–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ\s*–≤\s*—Ä—Ñ"
    ]

	def contains_any(segment: str, keywords: list[str]) -> bool:
		return any(kw in segment for kw in keywords)

	def has_strict_russia(segment: str) -> bool:
		# –Ø–≤–Ω—ã–µ —Å—Ç—Ä–æ–≥–æ—Å—Ç—å/–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
		for p in strict_russia_patterns:
			if re.search(p, segment):
				return True
		# –ü—Ä–æ—Å—Ç–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –†–§/–†–æ—Å—Å–∏—è –ë–ï–ó –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö/—Ä–∞–∑—Ä–µ—à–∞—é—â–∏—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫ ‚Äî —Å—á–∏—Ç–∞–µ–º —Å—Ç—Ä–æ–≥–∏–º
		if re.search(r"\b—Ä—Ñ\b|\b—Ä–æ—Å—Å–∏—è\b", segment):
			if not contains_any(segment, friendly_keywords) and not contains_any(segment, broad_allow_keywords):
				return True
		return False

	def segment_is_strict(segment: str) -> bool:
		# –ï—Å–ª–∏ —è–≤–Ω–æ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ/—Ä–∞–∑—Ä–µ—à–∞—é—â–∏–µ ‚Äî –Ω–µ —Å—Ç—Ä–æ–≥–∏–π
		if contains_any(segment, friendly_keywords) or contains_any(segment, broad_allow_keywords):
			return False
		# –ò–Ω–∞—á–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä–æ–≥–æ—Å—Ç—å –†–§
		return has_strict_russia(segment)

	strict_citizenship = False
	strict_location = False

	# 1) –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ
	m_cit = re.search(r"–≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ\s*[:\-]?\s*(.+)", text_lower, flags=re.IGNORECASE)
	if m_cit:
		strict_citizenship = segment_is_strict(m_cit.group(1))

	# 2) –õ–æ–∫–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
	m_loc = re.search(r"–ª–æ–∫–∞—Ü(?:–∏—è|–∏)\s*(?:—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞)?\s*[:\-]?\s*(.+)", text_lower, flags=re.IGNORECASE)
	if m_loc:
		strict_location = segment_is_strict(m_loc.group(1))

	# –û—Ç—Å–µ–∫–∞–µ–º, –µ—Å–ª–∏ –ª—é–±–æ–π –±–ª–æ–∫ —Å—Ç—Ä–æ–≥–∏–π
	return strict_citizenship or strict_location




import pymorphy2

def oplata_filter(text: str) -> bool:
    morph = pymorphy2.MorphAnalyzer()
    filters_raw = [
        "–∞–∫—Ç—ã –ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ", "–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ",
        "–ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è –æ–ø–ª–∞—Ç–∞", "–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ",
        "–ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ", "–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è –æ–ø–ª–∞—Ç–∞", "–ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è"
    ]

    # –ü—Ä–∏–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
    text_lower = text.lower()
    
    # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª–Ω—ã–µ —Ñ—Ä–∞–∑—ã
    for phrase in filters_raw:
        if phrase.lower() in text_lower:
            return True
    
    # –ï—Å–ª–∏ —Ñ—Ä–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
    text_words = text_lower.split()
    
    for word in text_words:
        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å–ª–æ–≤–æ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        parsed_word = morph.parse(word)[0]
        normal_word = parsed_word.normal_form
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —ç—Ç–æ —Å–ª–æ–≤–æ –≤ —Å–ø–∏—Å–∫–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        for filter_phrase in filters_raw:
            filter_words = filter_phrase.lower().split()
            for filter_word in filter_words:
                # –ò—â–µ–º —Ç–æ–ª—å–∫–æ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ø—Ä–æ—Å—Ç–æ "–æ–ø–ª–∞—Ç–∞"
                if normal_word == filter_word and filter_word not in ["–æ–ø–ª–∞—Ç–∞"]:
                    return True
                # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —Å–ª–æ–≤–æ "–ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ" –∏–ª–∏ "–∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–π" - —Ç–æ—á–Ω–æ True
                elif "–∫–≤–∞—Ä—Ç–∞–ª" in normal_word or "–ø–æ–∫–≤–∞—Ä—Ç–∞–ª" in normal_word:
                    return True
    
    return False





def check_project_duration(text: str) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –º–µ–Ω–µ–µ 3 –º–µ—Å—è—Ü–µ–≤.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ç–∞–∫–∏–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è (–≤–∞–∫–∞–Ω—Å–∏—é –Ω—É–∂–Ω–æ –æ—Ç—Å–µ—á—å).
    –ü—Ä–æ–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç 3 –º–µ—Å—è—Ü–µ–≤ –∏ –±–æ–ª–µ–µ.
    """
    import re
    text_lower = text.lower()

    # –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å —á–∏—Å–ª–∞–º–∏ ‚Äî –∏—â–µ–º —Ç–æ–ª—å–∫–æ "1" –∏–ª–∏ "2" (–º–µ–Ω–µ–µ 3 –º–µ—Å—è—Ü–µ–≤)
    numeric_patterns = [
        r':\s*(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',  # –ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è ": X –º–µ—Å—è—Ü–µ–≤"
        r'(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)\s*(?:–∏\s*–º–µ–Ω–µ–µ|–∏–ª–∏\s*–º–µ–Ω–µ–µ|–¥–æ)',
        r'–æ—Ç\s*(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)\s*(?:–∏\s*–º–µ–Ω—å—à–µ|–∏–ª–∏\s*–º–µ–Ω—å—à–µ)',
        r'–º–µ–Ω–µ–µ\s*(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–¥–æ\s*(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)\s*(?:–º–∞–∫—Å–∏–º—É–º|–º–∞–∫—Å)',
        r'–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å\s*(?:–ø—Ä–æ–µ–∫—Ç–∞)?\s*(?:–æ—Ç\s*)?(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å\s*–ø—Ä–æ–µ–∫—Ç–∞\s*:\s*(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å\s*(?:–ø—Ä–æ–µ–∫—Ç–∞)?\s*(?:–æ—Ç\s*)?(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'—Å—Ä–æ–∫\s*(?:–ø—Ä–æ–µ–∫—Ç–∞)?\s*(?:–æ—Ç\s*)?(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–∫–æ–Ω—Ç—Ä–∞–∫—Ç\s*(?:–Ω–∞\s*)?(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'—Ä–∞–±–æ—Ç–∞\s*(?:–Ω–∞\s*)?(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–∑–∞–Ω—è—Ç–æ—Å—Ç—å\s*(?:–Ω–∞\s*)?(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–ø–µ—Ä–∏–æ–¥\s*(?:—Ä–∞–±–æ—Ç—ã)?\s*(?:–æ—Ç\s*)?(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–≤—Ä–µ–º—è\s*(?:—Ä–∞–±–æ—Ç—ã)?\s*(?:–æ—Ç\s*)?(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–ø—Ä–æ–µ–∫—Ç\s*(?:—Ä–∞—Å—Å—á–∏—Ç–∞–Ω)?\s*(?:–Ω–∞\s*)?(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–∑–∞–¥–∞—á–∞\s*(?:–Ω–∞\s*)?(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'—Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ\s*(?:–Ω–∞\s*)?(\d+)\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–≤—Ä–µ–º–µ–Ω–Ω—ã–µ\s*—Ä–∞–º–∫–∏\s*(?:–æ—Ç\s*)?(\d+)\s*(?:–¥–æ\s*)?(\d+)?\s*(–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)'
    ]

    for pattern in numeric_patterns:
        for match in re.findall(pattern, text_lower):
            nums = [int(x) for x in match if x.isdigit()]
            # –û—Ç—Å–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —á–∏—Å–ª–∞ –º–µ–Ω—å—à–µ 3 (1 –∏–ª–∏ 2 –º–µ—Å—è—Ü–∞)
            if any(n < 3 for n in nums):
                return True
            # –ï—Å–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –º–µ–Ω—å—à–µ 3, —Ç–æ–∂–µ –æ—Ç—Å–µ–∫–∞–µ–º
            if nums and max(nums) < 3:
                return True

    # –Ø–≤–Ω—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (–º–µ–Ω–µ–µ 3 –º–µ—Å—è—Ü–µ–≤)
    explicit_patterns = [
        r'–ø—Ä–æ–µ–∫—Ç\s+–Ω–∞\s*(?:1|2|–æ–¥–∏–Ω|–¥–≤–∞)\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'—Å—Ä–æ–∫\s*:\s*(?:1|2)\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å\s*:\s*(?:1|2)\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å\s*:\s*(?:1|2)\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–¥–æ\s*(?:1|2)\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–º–µ–Ω–µ–µ\s*3\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–º–µ–Ω—å—à–µ\s*3\s*(?:–º–µ—Å—è—Ü|–º–µ—Å|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü–µ–≤)',
        r'–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π\s*(?:–ø—Ä–æ–µ–∫—Ç|–∫–æ–Ω—Ç—Ä–∞–∫—Ç)',
        r'–≤—Ä–µ–º–µ–Ω–Ω–∞—è\s*(?:—Ä–∞–±–æ—Ç–∞|–∑–∞–Ω—è—Ç–æ—Å—Ç—å)',
        r'–∫–æ—Ä–æ—Ç–∫–∏–π\s*(?:–ø—Ä–æ–µ–∫—Ç|—Å—Ä–æ–∫)',
        
    ]

    for pattern in explicit_patterns:
        if re.search(pattern, text_lower):
            return True

    return False


text = """

üÜîBE-8636

Scala Developer

–ú–µ—Å—è—á–Ω–∞—è —Å—Ç–∞–≤–∫–∞(–Ω–∞ —Ä—É–∫–∏) –¥–æ: 168 400 RUB

–û –∫–∞–Ω–¥–∏–¥–∞—Ç–µ:

–ì—Ä–µ–π–¥: Middle+ / Senior
–õ–æ–∫–∞—Ü–∏—è:  –†–ë
–¢–∞–π–º-–∑–æ–Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞: –º—Å–∫

–û –ø—Ä–æ–µ–∫—Ç–µ:
–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: * –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –±–∞–Ω–∫ –†–§
–î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞: ASAP
–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ : –æ—Ç 2 –º–µ—Å—è—Ü–µ–≤


–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ:
–¢–∏–ø –∑–∞–Ω—è—Ç–æ—Å—Ç–∏: —É–¥–∞–ª—ë–Ω–∫–∞
–ó–∞–≥—Ä—É–∑–∫–∞: —Ñ—É–ª–ª-—Ç–∞–π–º
–û—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è: –Ω—É–∂–Ω–∞ –ª–∏—á–Ω–∞—è –ø–æ—á—Ç–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –¥–ª—è –Ω–µ–π–º—á–µ–∫–∞.
–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–∞–Ω–¥–∏–¥–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å –Ω–µ –ø–æ–¥–∞–≤–∞–ª–∏—Å—å –Ω–∞ –ø—Ä–æ–µ–∫—Ç—ã –¢–ë–∞–Ω–∫–∞

–í–æ–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–∏—à–∏—Ç–µ –î–º–∏—Ç—Ä–∏—é ‚û°Ô∏è@Dimitryver. –£–∫–∞–∑–∞—Ç—å üÜî –∑–∞–ø—Ä–æ—Å–∞.

üìù–ü—Ä–∏—Å—ã–ª–∞—Ç—å –°V + –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–Ω–¥–∏–¥–∞—Ç—É:
 –§–ò–û
 –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
 –ø–æ—á—Ç–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –¥–ª—è –Ω–µ–π–º—á–µ–∫–∞
 –õ–æ–∫–∞—Ü–∏—è (–≥–æ—Ä–æ–¥)
 –í–æ–∑–º–æ–∂–Ω–∞—è –¥–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞ –Ω–∞ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
–ü–ª–∞–Ω—ã –Ω–∞ –æ—Ç–ø—É—Å–∫ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3 –º–µ—Å—è—Ü–∞
 –û—Ü–µ–Ω–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –î–ê/–ù–ï–¢, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–∞–ª–∏—á–∏–µ–º –æ–ø—ã—Ç–∞.Ô∏è

üìå –ó–∞–¥–∞—á–∏:

üíª –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- –û–ø—ã—Ç: –Ω–µ –º–µ–Ω–µ–µ 2 –ª–µ—Ç –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –º–∏–¥–¥–ª+
- –ó–Ω–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –≤–∫–ª—é—á–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–∞—Ä–∞–¥–∏–≥–º—É
- –£–º–µ–Ω–∏–µ –ø–∏—Å–∞—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
- –ó–Ω–∞–Ω–∏–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (ZIO, Cats, ScalaTest)
- –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –ë–î (PostgreSQL)
- –û–ø—ã—Ç –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ REST / JSON-RPC
- –ó–Ω–∞–Ω–∏–µ Git
- –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å Jira / Wiki

- –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å MongoDB, ElasticSearch, Kafka, Redis
- –û–ø—ã—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ / —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã ZIO
"""

print(is_russia_only_citizenship(text=text))


VACANCY_ID_REGEX = re.compile(
    r"(?:üÜî\s*)?(?:[\w\-\u0400-\u04FF]+[\s\-]*)?(\d+)",
    re.IGNORECASE
)

def extract_vacancy_id_and_text(text: str):
    match = VACANCY_ID_REGEX.search(text)
    vacancy_id = match.group(1) if match else None
    clean_text = VACANCY_ID_REGEX.sub("", text).strip()
    return vacancy_id, clean_text


def remove_vacancy_id(text: str) -> str:
    """
    –£–¥–∞–ª—è–µ—Ç –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É, –µ—Å–ª–∏ –æ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç ID –≤–∞–∫–∞–Ω—Å–∏–∏
    (–Ω–∞–ø—Ä–∏–º–µ—Ä: üÜî04100101, üÜî QA-8955, QA-8955, DEV-102, 04100101),
    –Ω–æ –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç –¥–∞—Ç—É –∏ –æ—Å—Ç–∞–ª—å–Ω–æ–π —Ç–µ–∫—Å—Ç.
    """
    lines = text.strip().splitlines()

    if not lines:
        return text.strip()

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –Ω–∞ ID
    first_line = lines[0].strip()

    # –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è ID: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π üÜî, –±—É–∫–≤—ã/—Ü–∏—Ñ—Ä—ã/–¥–µ—Ñ–∏—Å—ã, –Ω–µ –¥–∞—Ç–∞
    id_pattern = re.compile(r"^(?:üÜî\s*)?[\w\-]+$", re.IGNORECASE)

    if id_pattern.match(first_line):
        # –£–¥–∞–ª—è–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É
        lines = lines[1:]

    clean_text = "\n".join(lines)

    # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ (–º–∞–∫—Å–∏–º—É–º 2 –ø–æ–¥—Ä—è–¥)
    clean_text = re.sub(r"\n{3,}", "\n\n", clean_text)

    return clean_text.strip()




async def send_mess_to_group(group_id: int, message: str, vacancy_id: str, bot: Bot):
    seq_num = await get_next_sequence_number()
    text = remove_vacancy_id(message)
    vacancy_id = vacancy_id[-4:]
    vacancy_id = f'{seq_num:04d}{vacancy_id}'
    pometka = f'"üì® –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ä–µ–∑—é–º–µ —Å –ø–æ–º–µ—Ç–∫–æ–π ¬´{vacancy_id} Ruby of Rails¬ª, –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã (–Ω–∞ —Ä—É–∫–∏), —Ñ–æ—Ä–º—É —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è, –Ω–∞ e-mail: cv@omega-solutions.ru"'
    heashtegs_gpt = await generate_hashtags_gemini(text)
    heashegs = f'#vacancy #—Ä–∞–±–æ—Ç–∞ #job #remote #—É–¥–∞–ª—ë–Ω–∫–∞ #OmegaVacancy\n{heashtegs_gpt}\n#{vacancy_id}'
    text_for_message = f'üÜî{vacancy_id}\n\n{text}\n\n{pometka}\n\n{heashegs}'
    await bot.send_message(group_id, text_for_message, parse_mode="HTML")
    
    

def get_message_datetime(msg, tz: str = "Europe/Moscow") -> str:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD.MM.YYYY HH:MM
    —Å —É—á—ë—Ç–æ–º —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–∞–π–º–∑–æ–Ω—ã.

    :param msg: –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (msg.date ‚Äî datetime –≤ UTC)
    :param tz: —Å—Ç—Ä–æ–∫–∞ —Å —Ç–∞–π–º–∑–æ–Ω–æ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "Europe/Moscow")
    :return: —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º
    """
    # –ë–µ—Ä—ë–º –¥–∞—Ç—É –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è (–≤—Å–µ–≥–¥–∞ UTC)
    utc_date = msg.date  

    # –ü–µ—Ä–µ–≤–æ–¥–∏–º –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –∑–æ–Ω—É
    target_tz = pytz.timezone(tz)
    local_date = utc_date.astimezone(target_tz)

    return local_date.strftime("%d.%m.%Y %H:%M")

def get_vacancy_title(text: str) -> str | None:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Äî —Å—Ç—Ä–æ–∫—É, –Ω–∞—á–∏–Ω–∞—é—â—É—é—Å—è —Å ü•á.
    –ü—Ä–∏–º–µ—Ä:
    ü•á –ê–Ω–∞–ª–∏—Ç–∏–∫ Colvir (Middle+/Senior) ‚Üí "–ê–Ω–∞–ª–∏—Ç–∏–∫ Colvir (Middle+/Senior)"
    """
    if not text:
        return None

    pattern = re.compile(r'^\s*ü•á\s*(.+)$', re.MULTILINE)
    match = pattern.search(text)
    if match:
        return match.group(1).strip()

    return None


def format_candidate_json_str(raw_str: str) -> str:
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É JSON (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Å ```json ``` –∏–ª–∏ —Ç—Ä–æ–π–Ω—ã–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏),
    –ø–∞—Ä—Å–∏—Ç –µ—ë –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—Ä–∞—Å–∏–≤–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è Telegram —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏.
    """
    # –£–±–∏—Ä–∞–µ–º ```json –∏ ``` –ø–æ –∫—Ä–∞—è–º
    cleaned_str = re.sub(r'^```json\s*', '', raw_str.strip())
    cleaned_str = re.sub(r'```$', '', cleaned_str.strip())

    # –ü—Ä–æ–±—É–µ–º —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON
    try:
        candidate_json = json.loads(cleaned_str)
    except json.JSONDecodeError:
        return "‚ùå –û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON"

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∫—Ä–∞—Å–∏–≤—ã–π —Ç–µ–∫—Å—Ç
    name = candidate_json.get("name", "")
    surname = candidate_json.get("surname", "")
    verdict = candidate_json.get("final_verdict", "")
    justification = candidate_json.get("justification", "")

    text = f"üë§ –ö–∞–Ω–¥–∏–¥–∞—Ç: {name} {surname}\n"
    text += f"üìå –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ: {verdict}\n\n"

    # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
    text += "üõ† –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏:\n"
    for skill in candidate_json.get("comparison_results", {}).get("required_skills", []):
        requirement = skill.get("requirement", "")
        status = skill.get("status", "")
        comment = skill.get("comment", "")
        text += f"- {requirement} ‚Äî {status}\n  {comment}\n\n"  # –¥–æ–±–∞–≤–ª–µ–Ω –ø–µ—Ä–µ–Ω–æ—Å –º–µ–∂–¥—É –Ω–∞–≤—ã–∫–∞–º–∏

    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
    plus_skills = candidate_json.get("comparison_results", {}).get("plus_skills", [])
    if plus_skills:
        text += "‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏:\n"
        for skill in plus_skills:
            text += f"- {skill}\n"
        text += "\n"

    # –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
    if justification:
        text += f"üìù –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:\n{justification}\n"

    return text

def extract_vacancy_id(text: str) -> str | None:
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç ID –≤–∞–∫–∞–Ω—Å–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞.
    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã:
      üÜî04100101, QA-8955, DEV-102, BE-9075, 8823
      –∞ —Ç–∞–∫–∂–µ —Å—Å—ã–ª–∫–∏:
      https://t.me/omega_vacancy_bot?start=2431_BE-8968
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ID –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "BE-8968" –∏–ª–∏ "8823").
    """
    if not text:
        return None

    # üü° –ë–µ—Ä—ë–º –ø–µ—Ä–≤—É—é –Ω–µ–ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
    lines = [line.strip() for line in text.strip().splitlines() if line.strip()]
    if not lines:
        return None
    first_line = lines[0]

    # üü¢ 1. –ò—â–µ–º ID –≤ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (—Å –ª—é–±—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ –ø–æ—Å–ª–µ)
    id_pattern = re.compile(
        r"^(?:üÜî\s*)?([A-Z–ê-–Ø]{1,5}-?\d{3,6}|\d{3,6})",
        re.IGNORECASE
    )
    match = id_pattern.search(first_line)
    if match:
        return match.group(1).upper()

    # üü¢ 2. –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ ‚Äî –ø—Ä–æ–±—É–µ–º –¥–æ—Å—Ç–∞—Ç—å –∏–∑ —Å—Å—ã–ª–∫–∏ (start=XXXX_BE-XXXX)
    link_pattern = re.compile(
        r"start=\d+[_-]([A-Z–ê-–Ø]{1,5}-?\d{3,6}|\d{3,6})",
        re.IGNORECASE
    )
    match = link_pattern.search(text)
    if match:
        return match.group(1).upper()

    return None

text = """BE-8968 (https://t.me/omega_vacancy_bot?start=2431_BE-8968)
üìÖ –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: 22.09.2025 11:37

ü•á Senior Fullstack —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ Kotlin (Senior)

üí∞ –ú–µ—Å—è—á–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (–Ω–∞ —Ä—É–∫–∏) –¥–æ:
- –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –≤—ã–ø–ª–∞—Ç–∞ –®—Ç–∞—Ç/–ö–æ–Ω—Ç—Ä–∞–∫—Ç: 132 000 RUB
- –° –æ—Ç—Å—Ä–æ—á–∫–æ–π –ø–ª–∞—Ç–µ–∂–∞ "–°—Ä–æ–∫ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è" –ø–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –∞–∫—Ç–∞ (–ê–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–∂–µ–º–µ—Å—è—á–Ω–æ):
  –ò–ü: 168 000 RUB,
  –°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π: 189 000 RUB

üìç –õ–æ–∫–∞—Ü–∏—è/–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ: –†–§
üè† –§–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã: —É–¥–∞–ª—ë–Ω–Ω–æ
üéì –ì—Ä–µ–π–¥: Senior
üìÜ –°—Ä–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞: –±–µ—Å—Å—Ä–æ—á–Ω–æ
üöÄ –°—Ç–∞—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: 2 –Ω–µ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –∞–ø—Ä—É–≤–∞

üìå –û –ø—Ä–æ–µ–∫—Ç–µ:
DevX - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–π –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É–≤–µ–ª–∏—á–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –Ω–∞ —Ä—ã–Ω–æ–∫ –Ω–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤.

üìé –ó–∞–¥–∞—á–∏:

üíª –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
‚Äî –£–≤–µ—Ä–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ Kotlin
‚Äî –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å
‚Äî –ù–∞–ø–∏—Å–∞–Ω–∏–µ unit –∏ integration —Ç–µ—Å—Ç–æ–≤ (JUnit, Testcontainers)
‚Äî –†–∞–±–æ—Ç–∞ —Å Gradle (Kotlin DSL)
‚Äî –£–≤–µ—Ä–µ–Ω–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ TypeScript
‚Äî –û–ø—ã—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Node.js / Express / tRPC
‚Äî –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å WebView, Electron –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∞–º–∏
‚Äî –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏ –∏ CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –Ω–∞ TypeScript
‚Äî –ó–Ω–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (DI, –º–æ–¥—É–ª–∏, —Å–ª–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤)
‚Äî –†–∞–±–æ—Ç–∞ —Å WebSocket / SSE / EventBus
‚Äî –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å backend-–ª–æ–≥–∏–∫–æ–π –Ω–∞ TypeScript
‚Äî –û–ø—ã—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ IDE-–ø–ª–∞–≥–∏–Ω–æ–≤ (JetBrains Platform SDK, VSCode API)
‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ (GitHub Actions, GitLab CI)
‚Äî –†–∞–±–æ—Ç–∞ —Å Docker, –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è DevOps-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

‚ö†Ô∏è –û—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è:
‚Äî –¢–∞–π–º-–∑–æ–Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞: –ú—Å–∫
‚Äî –ó–∞–≥—Ä—É–∑–∫–∞: —Ñ—É–ª–ª-—Ç–∞–π–º

‚ùóÔ∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–Ω–¥–∏–¥–∞—Ç—É –ø—Ä–∏ –ø–æ–¥–∞—á–µ:
‚óè –§–ò–û
‚óè –°—Ç—Ä–∞–Ω–∞ + –ì–æ—Ä–æ–¥
‚óè –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (–Ω–µ –≤–æ–∑—Ä–∞—Å—Ç, –∞ –¥–∞—Ç–∞)
‚óè –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞
‚óè –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–í–£–ó, –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å)
‚óè –ì—Ä–µ–π–¥
‚óè –°—Ç–∞–≤–∫–∞
‚óè –ß–µ–∫-–ª–∏—Å—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (–î–ê/–ù–ï–¢)

–ö–æ–Ω—Ç–∞–∫—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤: @amt2809
# """
print(extract_vacancy_id(text))