# OmegaVacancyBot ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π/—Ö–µ–Ω–¥–ª–µ—Ä–æ–≤

–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: 16.10.2025

============================================================
1) –û–±—â–∏–π –æ–±–∑–æ—Ä
============================================================
- –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞: —Å–±–æ—Ä –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤–∞–∫–∞–Ω—Å–∏–π (—á–µ—Ä–µ–∑ Telethon –∏ GPT/Gemini), –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—é–º–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ (–ø–∏—Å—å–º–∞/—Å–æ–æ–±—â–µ–Ω–∏—è).
- –°—Ç–µ–∫: aiogram (Telegram Bot API), Telethon (–∫–ª–∏–µ–Ω—Ç Telegram), SQLAlchemy (SQLite), Google Sheets (gspread), Google Gemini API, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (docx, pdf, rtf, txt), SMTP/IMAP –¥–ª—è –ø–æ—á—Ç—ã.
- –ì–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞: `main.py`. –ó–¥–µ—Å—å —Å–æ–∑–¥–∞—ë—Ç—Å—è `Bot`, `Dispatcher`, –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —Ä–æ—É—Ç–µ—Ä—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —Ñ–æ–Ω–æ–≤–æ–µ —Å–ª–µ–∂–µ–Ω–∏–µ Telethon –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏.

============================================================
2) –ü–æ—Ç–æ–∫–∏ –∏ –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã
============================================================
- –ó–∞–ø—É—Å–∫ (`main.py`):
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (`init_db()`), —Å—Ç–∞—Ä—Ç Telethon-–∫–ª–∏–µ–Ω—Ç–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–ª—É—à–∞—Ç–µ–ª–µ–π –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–π, –∑–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á:
    - `monitor_and_cleanup()` ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è/—É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö/—Å—Ç–æ–ø–Ω—É—Ç—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π.
    - `check_and_delete_duplicates()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ ID –≤ —Ü–µ–ª–µ–≤–æ–º –∫–∞–Ω–∞–ª–µ.
    - `check_old_messages_and_mark()` ‚Äî —á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–∞–Ω–∞–ª–µ.
    - `periodic_cleanup_task()` ‚Äî –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü —Ä–µ–∑—é–º–µ.
    - `update_currency_sheet()` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –≤ Google Sheets.
  - –ó–∞–ø—É—Å–∫ –ø–æ–ª–ª–∏–Ω–≥–∞ aiogram-–±–æ—Ç–∞.

- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–π:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: Telethon —Å–ª—É—à–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Ç–æ–ø–∏–∫–∞–º-–∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ Gemini (`process_vacancy_with_gemini` ‚Üí —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `format_vacancy_gemini`), –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –≤ —Ü–µ–ª–µ–≤–æ–π –∫–∞–Ω–∞–ª/—Ç–æ–ø–∏–∫, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞–ø–ø–∏–Ω–≥ `MessageMapping`, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –≥—Ä—É–ø–ø—É.
  - –í—Ä—É—á–Ω—É—é: —á–µ—Ä–µ–∑ –±–æ—Ç–∞ (`/start` –±–µ–∑ payload ‚Üí –º–µ–Ω—é ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é –≤—Ä—É—á–Ω—É—é"), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç ‚Üí —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è/–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Gemini ‚Üí –≤—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ —Ç–æ–ø–∏–∫–∞ ‚Üí –ø—É–±–ª–∏–∫–∞—Ü–∏—è.

- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∑—é–º–µ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é:
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –±–æ—Ç–∞ –∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ (start=messageId_vacId) ‚Üí –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–∫–∞–Ω—Å–∏—é –∏ –ø—Ä–æ—Å–∏—Ç —Ä–µ–∑—é–º–µ ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–∏–¥–∞–µ—Ç —Ñ–∞–π–ª—ã ‚Üí –±–æ—Ç –∞–∫–∫—É–º—É–ª–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —á–µ—Ä–µ–∑ 2 —Å–µ–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç ¬´–¥–æ–±–∞–≤–∏—Ç—å –µ—â—ë¬ª.
  - –ü–æ –∫–Ω–æ–ø–∫–µ ¬´–ù–µ—Ç¬ª: —Ä–µ–∑—é–º–µ –ø–∞—á–∫–æ–π –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–≤–µ—Ä–∫—É `sverka_vac_and_resume_json` ‚Üí –±–æ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–∫–∏ ¬´–§–∏–Ω–∞–ª–∏—Å—Ç—ã¬ª, ¬´–¢—Ä–µ–±—É—é—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–π¬ª, ¬´–û—Ç–∫–∞–∑—ã¬ª, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ –ë–î –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π.
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å–µ–º –∫–∞–Ω–¥–∏–¥–∞—Ç—É/–∫–ª–∏–µ–Ω—Ç—É –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏.

============================================================
3) –§–∞–π–ª—ã –∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
============================================================

------------------------------------------------------------
3.1 `main.py`
------------------------------------------------------------
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `BOT_TOKEN`, `PHONE_NUMBER`, `GROUP_ID`, `ADMIN_ID`.
- –°–æ–∑–¥–∞–Ω–∏–µ `Bot`, `Dispatcher`, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤: `bot_router` (–∏–∑ `aiogram_bot.py`), `pr_router` (–∏–∑ `privyazka_messangers.py`).
- `main()`:
  - –°—Ç–∞—Ä—Ç `telethon_client` –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–ª—É—à–∞—Ç–µ–ª–µ–π: `register_topic_listener(...)`, `register_simple_edit_listener(...)`.
  - –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏: `monitor_and_cleanup`, `check_and_delete_duplicates`, `check_old_messages_and_mark`, `periodic_cleanup_task`, `update_currency_sheet`.
  - `dp.start_polling(bot)` ‚Äî –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞.

------------------------------------------------------------
3.2 `aiogram_bot.py` ‚Äî aiogram-–±–æ—Ç, FSM, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
------------------------------------------------------------
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ:
  - `bot_router = Router()` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä –±–æ—Ç–∞.
  - –°–æ—Å—Ç–æ—è–Ω–∏—è FSM: `AddChannel`, `ScanHand`, `ScanVacRekr`, `WaitForNewResume`.
  - `TOPIC_MAP` ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (src_chat, src_topic) ‚Üí (dst_chat, dst_topic) –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.
  - –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã: `SAVE_DIR`, `escape_md`, —Å–ª–æ–≤–∞—Ä–∏ –±—É—Ñ–µ—Ä–æ–≤ –∑–∞–≥—Ä—É–∑–æ–∫.

- –•–µ–Ω–¥–ª–µ—Ä—ã –∫–æ–º–∞–Ω–¥/—Å–æ–æ–±—â–µ–Ω–∏–π:
  - `@bot_router.message(CommandStart()) -> cmd_start(message, command, state)`
    - –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è, –ø–æ–∫–∞–∑ –º–µ–Ω—é –¥–ª—è –∞–¥–º–∏–Ω–æ–≤, –ª–∏–±–æ, –µ—Å–ª–∏ payload `start=messageId_vacId`, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–∫–∞–Ω—Å–∏—é –ø–æ —Å—Å—ã–ª–∫–µ –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `ScanVacRekr.waiting_for_vac` ‚Äî –æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—é–º–µ.

  - –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ –ø–æ –≤–∞–∫–∞–Ω—Å–∏–∏:
    - `@bot_router.message(F.document, ScanVacRekr.waiting_for_vac) -> scan_vac_rekr` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `save_document(...)`.
    - `save_document(message, state, bot)` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –≤ `downloads/<user_id>/`, –∞–∫–∫—É–º—É–ª–∏—Ä—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —á–µ—Ä–µ–∑ 2 —Å–µ–∫ –≤—ã–¥–∞—ë—Ç –∏—Ç–æ–≥–æ-—Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É `scan_vac_rekr_yn_kb()` (¬´–î–∞/–ù–µ—Ç¬ª), —á–µ—Ä–µ–∑ 10 —Å–µ–∫ ‚Äî —Å–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–∞.
    - `@bot_router.callback_query(F.data == "yes_vac_rekr") -> scan_vac_rekr_y` ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É.
    - `@bot_router.callback_query(F.data == "no_vac_rekr") -> scan_vac_rekr_n` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
      - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ `process_file_and_gpt(...)` ‚Üí `sverka_vac_and_resume_json` ‚Üí —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç—Ä–∏ —Å–ø–∏—Å–∫–∞: —Ñ–∏–Ω–∞–ª–∏—Å—Ç—ã/—É—Ç–æ—á–Ω–µ–Ω–∏–µ/–æ—Ç–∫–∞–∑.
      - –ü–æ –∫–∞–∂–¥–æ–º—É –∫–∞–Ω–¥–∏–¥–∞—Ç—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î: `add_final_resume` / `add_utochnenie_resume` / `add_otkonechenie_resume`.
      - –í –∫–æ–Ω—Ü–µ ‚Äî –∫–Ω–æ–ø–∫–∞ `add_another_resume_kb()`.

  - –í—ã–≤–æ–¥ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–∞:
    - `@bot_router.callback_query(F.data == "utochnit_prichinu") -> utochnit_prichinu_bot`
      - –î–æ—Å—Ç–∞—ë—Ç –∏–∑ –ë–î –ø–æ `message_id` —Ç–µ–∫—Å—Ç –æ—Ç–∫–∞–∑–∞ –∏ –ø–æ–¥–º–µ–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.

  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç—É:
    - `@bot_router.callback_query(F.data.startswith("generate_mail:")) -> generate_mail_bot`
      - –ü–æ —Ç–∏–ø—É –≤–µ—Ä–¥–∏–∫—Ç–∞ (`PP/CP/NP`) –±–µ—Ä—ë—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å –∏–∑ –ë–î, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–∏—Å—å–º–æ: `create_mails(...)`.
      - –î–ª—è ¬´–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥—Ö–æ–¥–∏—Ç¬ª –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É `send_mail_or_generate_client_mail_kb()` (–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç—É/—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∏—Å—å–º–æ –∫–ª–∏–µ–Ω—Ç—É), –∏–Ω–∞—á–µ ‚Äî `send_mail_to_candidate_kb(verdict)`.

  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞ –∫–ª–∏–µ–Ω—Ç—É:
    - `@bot_router.callback_query(F.data == "generate_klient_mail") -> generate_klient_mail_bot`
      - –ë–µ—Ä—ë—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–∏–Ω–∞–ª–∏—Å—Ç–∞ –∏–∑ –ë–î ‚Üí `generate_cover_letter_for_client(...)` ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –∫–∞–Ω–∞–ª –∫–ª–∏–µ–Ω—Ç–∞ `CLIENT_CHANNEL` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤ —á–∞—Ç–µ —Å –∫–Ω–æ–ø–∫–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞.

  - –í–æ–∑–≤—Ä–∞—Ç –∫ –ø–∏—Å—å–º—É –∫–∞–Ω–¥–∏–¥–∞—Ç—É:
    - `@bot_router.callback_query(F.data == "back_to_mail_kand") -> back_to_mail_kand_bot` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–∏—Å—å–º–æ –∫–∞–Ω–¥–∏–¥–∞—Ç—É —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.

  - –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π —Å–≤–µ—Ä–∫–∏ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:
    - `@bot_router.callback_query(F.data.startswith("get_all_info:")) -> get_all_info_bot` ‚Äî –ø–æ–¥–º–µ–Ω—è–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É –Ω–∞ —Ç–µ–∫—Å—Ç —Å–≤–µ—Ä–∫–∏ –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∏—Å—å–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–∏–ø–∞.

  - –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç—É:
    - `@bot_router.callback_query(F.data.startswith("send_mail_to_candidate")) -> send_mail_to_candidate_bot`
      - –ü–æ–ª—É—á–∞–µ—Ç –∏–∑ –ë–î JSON –∫–∞–Ω–¥–∏–¥–∞—Ç–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ `create_contacts_kb(contacts, verdict)`.
    - `@bot_router.callback_query(F.data.startswith("con:")) -> send_mail_to_candidate_bot`
      - –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞:
        - `con:t:<@username>:<verdict>` ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram —á–µ—Ä–µ–∑ `send_message_by_username` (Telethon).
        - `con:e:<email>:<verdict>` ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ —á–µ—Ä–µ–∑ `send_email_gmail(...)`.
        - `con:p:<phone>:<verdict>` ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –≤ —á–∞—Ç.

  - –ü—Ä–æ—á–µ–µ:
    - `@bot_router.callback_query(F.data == "back_to_menu") -> back_to_menu`
    - `@bot_router.callback_query(F.data == 'scan_redlab')` / `'scan_redlab_day'` / `'scan_redlab_21'` ‚Üí –∑–∞–ø—É—Å–∫ `forward_messages_from_topics(...)` c —Ä–∞–∑–Ω—ã–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏.
    - –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–∏: `@bot_router.callback_query(F.data == 'scan_hand') -> scan_hand` ‚Üí –ø–µ—Ä–µ–≤–æ–¥ –≤ `ScanHand.waiting_for_hand`.
      - `@bot_router.message(ScanHand.waiting_for_hand) -> scan_hand_message` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è/–æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Gemini, —Ä–∞—Å—á—ë—Ç –±–ª–æ–∫–æ–≤ –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ø–∏–∫.
      - `@bot_router.callback_query(ScanHand.waiting_for_topic, F.data.startswith("topic:")) -> scan_hand_topic` ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–æ–ø–∏–∫, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –≥—Ä—É–ø–ø—É –∏ —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è.
    - –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∫–Ω–æ–ø–∫–∏ Viber: `@bot_router.message(F.text == "/phone") -> send_phone`.
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ—â—ë —Ä–µ–∑—é–º–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏: `@bot_router.callback_query(F.data == 'add_another_resume') -> add_another_resume_bot` –∏ `@bot_router.message(F.document, WaitForNewResume.waiting_for_new_resume) -> new_resume_after_scan`.
    - –ó–∞–ø—Ä–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –≤–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏–∏: `@bot_router.message(F.document) -> document_without_state`.

- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏:
  - `escape_md(text)`, `save_document(...)` –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –±—É—Ñ–µ—Ä—ã/—Ç–∞–π–º–µ—Ä—ã –¥–ª—è –∞–∫–∫—É–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–æ–∫.

------------------------------------------------------------
3.3 `kb.py` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä
------------------------------------------------------------
- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é: `main_kb()` ‚Äî –∫–Ω–æ–ø–∫–∏ –¥–ª—è ¬´—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Redlab¬ª –∏ ¬´–¥–æ–±–∞–≤–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é –≤—Ä—É—á–Ω—É—é¬ª.
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç—è–º–∏: `channels_kb()`, `channel_kb(id)`, `slova_kb()`, `slovo_kb(id)`, `filters_kb()`, `filter_kb(id)`, ¬´–Ω–∞–∑–∞–¥‚Ä¶¬ª –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.
- –í—ã–±–æ—Ä —Ç–æ–ø–∏–∫–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: `send_kb()` (DevOps, Backend, Frontend –∏ —Ç.–¥.).
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Ä–µ–∑—é–º–µ: `scan_vac_rekr_yn_kb()`, `utochnit_prichinu_kb()`, `generate_mail_kb(verdict)`, `get_all_info_kb(verdict)`, `send_mail_to_candidate_kb(verdict)`, `send_mail_or_generate_client_mail_kb()`, `create_contacts_kb(contacts, verdict)`, `back_to_mail_kand_kb()`, `viber_kb()`, `add_another_resume_kb()`, `service_kb()`, `next_email_kb()`.

------------------------------------------------------------
3.4 `telethon_bot.py` ‚Äî —á—Ç–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ—Å—ã–ª–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π –∏–∑ —Ç–æ–ø–∏–∫–æ–≤
------------------------------------------------------------
- `telethon_client = TelegramClient('dmitryi', API_ID, API_HASH)` ‚Äî –∫–ª–∏–µ–Ω—Ç Telethon.
- `forward_messages_from_topics(telethon_client, TOPIC_MAP, AsyncSessionLocal, bot, days=14)`
  - –ù–∞—Ö–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ `src_topic_id`, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç (–∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã, –∑–∞—á—ë—Ä–∫–Ω—É—Ç—ã–µ, —Å—Ç–æ–ø-—Å–ª–æ–≤–∞), –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ Gemini: `process_vacancy_with_gemini` ‚Üí —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã–µ –±–ª–æ–∫–∏ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî —Å —Ä–∞—Å—á—ë—Ç–æ–º –∏–∑ Google Sheets `search_and_extract_values`) ‚Üí `format_vacancy_gemini` ‚Üí –ø—É–±–ª–∏–∫—É–µ—Ç –≤ —Ü–µ–ª–µ–≤–æ–π –∫–∞–Ω–∞–ª/—Ç–æ–ø–∏–∫ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –±–æ—Ç–∞ ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –≥—Ä—É–ø–ø—É `send_mess_to_group` ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞–ø–ø–∏–Ω–≥ `add_message_mapping`.
- `register_topic_listener(...)` ‚Äî —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ç–æ–ø–∏–∫–∞—Ö, –ª–æ–≥–∏–∫–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ `forward_messages_from_topics`, –Ω–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –æ–Ω–ª–∞–π–Ω.
- `send_message_by_username(username, text)` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

------------------------------------------------------------
3.5 `telethon_monitor.py` ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –≤–∞–∫–∞–Ω—Å–∏–π –∏ —á–∏—Å—Ç–∫–∞
------------------------------------------------------------
- –ú–∞—Ä–∫–µ—Ä—ã –∑–∞—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è: `has_strikethrough(message)`, `has_strikethrough_id(message, vacancy_id)`.
- `monitor_and_cleanup(telethon_client, AsyncSessionLocal, bot)` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ `MessageMapping`:
  - –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –∑–∞—á—ë—Ä–∫–Ω—É—Ç –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç ¬´—Å—Ç–æ–ø¬ª, –ª–∏–±–æ –∏—Å—Ç—ë–∫ –¥–µ–¥–ª–∞–π–Ω ‚Äî –ø–æ–º–µ—á–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ü–µ–ª–µ–≤–æ–º –∫–∞–Ω–∞–ª–µ –∫–∞–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–µ (—É–¥–∞–ª—è–µ—Ç –∏ –ø—É–±–ª–∏–∫—É–µ—Ç ¬´–≤–∞–∫–∞–Ω—Å–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞¬ª), —É–¥–∞–ª—è–µ—Ç –º–∞–ø–ø–∏–Ω–≥.
- `mark_inactive_and_schedule_delete(client, mapping, vacancy_id, bot)` –∏ `mark_as_deleted(client, msg_id, chat_id, vacancy_id, name_vac, bot)` ‚Äî –ø–µ—Ä–µ–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è ¬´–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ¬ª, –æ–∂–∏–¥–∞–Ω–∏–µ 24 —á–∞—Å–∞, —É–¥–∞–ª–µ–Ω–∏–µ.
- `check_and_delete_duplicates(teleton_client, channel_id, bot, topic_map)` ‚Äî —É–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã ID –≤ —Ü–µ–ª–µ–≤–æ–º –∫–∞–Ω–∞–ª–µ.
- `check_old_messages_and_mark(teleton_client, channel_id, bot)` ‚Äî —á–∏—Å—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å—Ç–∞—Ä—à–µ 14 –¥–Ω–µ–π.
- `register_simple_edit_listener(client, channel, bot)` + `on_edit(...)` ‚Äî —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π: –∑–∞—á—ë—Ä–∫–Ω—É—Ç—ã–π ID/¬´—Å—Ç–æ–ø¬ª ‚Üí –ø–æ–º–µ—Ç–∫–∞ –≤ —Ü–µ–ª–µ–≤–æ–º –∫–∞–Ω–∞–ª–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ.

------------------------------------------------------------
3.6 `scan_documents.py` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—é–º–µ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
------------------------------------------------------------
- –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤: `process_pdf`, `process_docx`, `process_doc`, `process_rtf`, `process_txt`.
- `process_file_and_gpt(path, bot, user_id, vac_text, file_name)` ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å–≤–µ—Ä–∫—É `background_sverka(...)`.
- `background_sverka(resume_text, vacancy_text, bot, user_id, file_name)` ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `sverka_vac_and_resume_json`, –∫—Ä–∞—Å–∏–≤–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç `display_analysis`, —á–∏—Å—Ç–∏—Ç JSON `clean_json`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–¥–∏–∫—Ç/–∏–º—è/—Ç–µ–∫—Å—Ç —Å–≤–µ—Ä–∫–∏.
- –û—Ç—á—ë—Ç –∏ —É—Ç–∏–ª–∏—Ç—ã: `clean_json`, `display_analysis`, `create_finalists_table(finalists)`, `create_mails(finalist, user_name)` ‚Äî —Ä–æ—É—Ç–∏–Ω–≥ –∫ `generate_mail_for_candidate_*`/`generate_cover_letter_for_client`.

------------------------------------------------------------
3.7 `gpt_gimini.py` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Gemini
------------------------------------------------------------
- `process_vacancy_with_gemini(text)` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤–∞–∫–∞–Ω—Å–∏–π –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª–µ–π (ID, —Å—Ç–∞–≤–∫–∞, –¥–µ–¥–ª–∞–π–Ω, –∑–∞–≥–æ–ª–æ–≤–æ–∫, –ª–æ–∫–∞—Ü–∏—è, —Ñ–ª–∞–≥–∏ —É—Å–ª–æ–≤–∏–π –∏ –¥—Ä.). –ü—Ä–∏ –æ—Ç—Å–µ–∏–≤–∞–Ω–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç reason/None.
- `format_vacancy_gemini(text, vacancy_id, date=None)` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —à–∞–±–ª–æ–Ω—É.
- `generate_hashtags_gemini(vacancy_text)` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö—ç—à—Ç–µ–≥–æ–≤.
- `sverka_vac_and_resume_json(vacancy_text, resume_text, file_name)` ‚Äî —Å–≤–µ—Ä–∫–∞ —Ä–µ–∑—é–º–µ —Å –≤–∞–∫–∞–Ω—Å–∏–µ–π, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–≥–∏–π JSON —Å –æ—Ü–µ–Ω–∫–æ–π must/nice-to-have, –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, –∑–∞—Ä–ø–ª–∞—Ç—ã, –≤–µ—Ä–¥–∏–∫—Ç–∞.
- –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (—á–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ):
  - `generate_mail_for_candidate_finalist(finalist, user_name)`
  - `generate_mail_for_candidate_utochnenie(finalist, user_name)`
  - `generate_mail_for_candidate_otkaz(finalist, user_name)`
  - `generate_cover_letter_for_client(candidate_json)`

------------------------------------------------------------
3.8 `googlesheets.py` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å Google Sheets
------------------------------------------------------------
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è `gspread` –ø–æ `creds.json`.
- `find_rate_in_sheet_gspread(search_value_usd)` ‚Äî –ø–æ–∏—Å–∫ —Å—Ç–∞–≤–∫–∏.
- `search_and_extract_values(search_column, search_value, extract_columns, worksheet_name, sheet_url)` ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π (–≤ —Ç.—á. –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π IP/—Å–∞–º–æ–∑–∞–Ω—è—Ç—ã–π –¥–æ 1000).
- `fill_column_with_sequential_numbers(column_letter, worksheet_name, start_row, value, sheet_id)` ‚Äî –º–∞—Å—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å –∫–æ–ª–æ–Ω–∫–∏.
- `update_currency_sheet(bot, ADMIN_ID)` ‚Äî —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ –ø–∞—Ä—Å–∏—Ç –∫—É—Ä—Å—ã —Å –¶–ë –†–§ (—á–µ—Ä–µ–∑ `parse_cb_rf`) –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ 2 –ª–∏—Å—Ç–∞.

------------------------------------------------------------
3.9 `funcs.py` ‚Äî —É—Ç–∏–ª–∏—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
------------------------------------------------------------
- –§–∏–ª—å—Ç—Ä –≤–∞–∫–∞–Ω—Å–∏–π: `check_project_duration(text)` ‚Äî –æ—Ç—Å–µ–∫–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç—ã < 3 –º–µ—Å –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤—É –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.
- –¢–µ–∫—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã: `remove_vacancy_id(text)`, `_clean_markup`, `extract_vacancy_id(text)` ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ/–æ—á–∏—Å—Ç–∫–∞ ID, `get_vacancy_title(text)` ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ –æ—Ç–º–µ—Ç–∫–µ ü•á.
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –≥—Ä—É–ø–ø—É: `send_mess_to_group(group_id, message, vacancy_id, bot)` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–∫–≤–æ–∑–Ω–æ–π —Å—á—ë—Ç—á–∏–∫, –ø–æ–º–µ—Ç–∫—É –∏ —Ö—ç—à—Ç–µ–≥–∏ (`generate_hashtags_gemini`).
- –î–∞—Ç–∞/–≤—Ä–µ–º—è —Å–æ–æ–±—â–µ–Ω–∏–π: `get_message_datetime(msg, tz)`.
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON –∫–∞–Ω–¥–∏–¥–∞—Ç–∞: `format_candidate_json_str(raw_str)`.
- –ü–∞—Ä—Å–µ—Ä –∫—É—Ä—Å–æ–≤ –¶–ë –†–§: `parse_cb_rf()`.

------------------------------------------------------------
3.10 `db.py` ‚Äî –º–æ–¥–µ–ª–∏ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ë–î (SQLite, SQLAlchemy Async)
------------------------------------------------------------
- –ú–æ–¥–µ–ª–∏:
  - `Channel`, `Filter`, `Slova` ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏.
  - `MessageMapping` ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π, —Å –¥–µ–¥–ª–∞–π–Ω–æ–º.
  - `LastSequenceNumber` ‚Äî —Å—á—ë—Ç—á–∏–∫ –¥–ª—è —Å–∫–≤–æ–∑–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π.
  - `OtkonechenieResume`, `UtochnenieResume`, `FinalResume` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å `message_id`, —Ç–µ–∫—Å—Ç–æ–º –∏ JSON.
  - `PrivyazanieMessangers` ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ –ø–æ—á—Ç –∫ tg-username.
  - `SaveResumes` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å—ã—Ä—ã–µ —Ä–µ–∑—é–º–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: `init_db()`.
- CRUD:
  - –ö–∞–Ω–∞–ª—ã/—Ñ–∏–ª—å—Ç—Ä—ã/—Å–ª–æ–≤–∞: `add_channel/remove_channel/get_all_channels`, `add_filter/get_all_filters/remove_filter`, `add_slovo/get_all_slova/remove_slovo`.
  - –ú–∞–ø–ø–∏–Ω–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π: `add_message_mapping/get_all_message_mappings/remove_message_mapping`.
  - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: `get_next_sequence_number`.
  - –†–µ–∑—é–º–µ: `add_final_resume/get_final_resume/remove_old_final_resumes`, `add_utochnenie_resume/get_utochnenie_resume/remove_old_utochnenie_resumes`, `add_otkonechenie_resume/get_otkolenie_resume/remove_old_otkonechenie_resumes`, –ø–µ—Ä–∏–æ–¥–∏–∫–∞ `periodic_cleanup_task`.
  - –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ä–µ–∑—é–º–µ: `add_save_resume/get_save_resume/remove_save_resume`.
  - –ü—Ä–∏–≤—è–∑–∫–∞ email: `add_email(user_name_tg, user_email, password)`.

------------------------------------------------------------
3.11 `send_email.py` ‚Äî SMTP/IMAP —É—Ç–∏–ª–∏—Ç—ã
------------------------------------------------------------
- `sanitize_header(value)` ‚Äî –æ—á–∏—Å—Ç–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.
- `send_email_gmail(sender_email, app_password, recipient_email, subject, body, html=False, attachments=None)` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—á—Ç—ã —á–µ—Ä–µ–∑ Gmail (aiosmtplib).
- `fetch_last_emails(imap_user, imap_pass, mailbox='inbox', limit=10)` ‚Äî —á—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–∏—Å–µ–º IMAP (Gmail).

------------------------------------------------------------
3.12 `privyazka_messangers.py` ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∫ –±–æ—Ç—É
------------------------------------------------------------
- –†–æ—É—Ç–µ—Ä: `pr_router = Router()`.
- FSM: `PrivyazkaEmail`, `PrivyazkaTelegram`.
- –•–µ–Ω–¥–ª–µ—Ä—ã:
  - `@pr_router.message(Command("add_account")) -> add_account` ‚Äî –≤—ã–±–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ (gmail/telegram).
  - `@pr_router.callback_query(F.data.in_(["gmail","telegram"])) -> add_gmail_account` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Gmail –∏ –∫–Ω–æ–ø–∫–∞ ¬´–î–∞–ª–µ–µ¬ª.
  - `@pr_router.callback_query(F.data == "next_email") -> next_email` ‚Äî –∑–∞–ø—Ä–æ—Å email –∏ –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `PrivyazkaEmail.waiting_for_email`.
  - `@pr_router.message(PrivyazkaEmail.waiting_for_email) -> add_email_account` ‚Äî –∑–∞–ø—Ä–æ—Å –ø–∞—Ä–æ–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
  - `@pr_router.message(PrivyazkaEmail.waiting_for_password) -> add_email_password` ‚Äî —Ç–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞, –∑–∞–ø–∏—Å—å –≤ –ë–î `add_email(...)`.

------------------------------------------------------------
3.13 `teleton_client.py` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Telethon (–∫–æ–Ω–≤–µ—Ä—Å–∏—è, HTML, —Å–∫–ª–æ–Ω–µ–Ω–∏—è)
------------------------------------------------------------
- –ü–æ–¥–ø–∏—Å–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞: `get_channel_info(channel_id_or_name, client, phone_number)`.
- –í—ã—Ö–æ–¥ –∏–∑ –∫–∞–Ω–∞–ª–∞: `leave_channel_listening(channel_id, client, phone_number)` (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –ø–æ–∫–∏–¥–∞–µ—Ç, –Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å).
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞–¥–µ–∂–Ω—ã—Ö —Ñ–æ—Ä–º: `generate_all_case_forms(phrase)`.
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `message` ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω—ã–π HTML —Å —É—á—ë—Ç–æ–º entities: `message_to_html_safe(message)`.

============================================================
4) –ü–µ—Ä–µ—á–µ–Ω—å –≤—Å–µ—Ö aiogram-—Ö–µ–Ω–¥–ª–µ—Ä–æ–≤ –∏ –ø–æ—Ä—è–¥–æ–∫
============================================================
- `@bot_router.message(CommandStart())` ‚Üí —Å—Ç–∞—Ä—Ç / –≤—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ –≤–∞–∫–∞–Ω—Å–∏–∏.
- `@bot_router.callback_query('scan_redlab'/'scan_redlab_day'/'scan_redlab_21')` ‚Üí —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤–∞–∫–∞–Ω—Å–∏–π –ø–æ —Ç–æ–ø–∏–∫–∞–º.
- `@bot_router.callback_query('scan_hand')` ‚Üí –≤–≤–æ–¥ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Üí `@bot_router.message(ScanHand.waiting_for_hand)` ‚Üí `@bot_router.callback_query(ScanHand.waiting_for_topic, 'topic:*')`.
- `@bot_router.message(F.document, ScanVacRekr.waiting_for_vac)` ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ ‚Üí `yes_vac_rekr`/`no_vac_rekr` ‚Üí —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.
- –ö–∞—Ä—Ç–æ—á–∫–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:
  - `get_all_info:*` ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Å–≤–µ—Ä–∫—É;
  - `generate_mail:*` ‚Üí —Å–æ–∑–¥–∞—Ç—å –ø–∏—Å—å–º–æ –∫–∞–Ω–¥–∏–¥–∞—Ç—É;
  - `generate_klient_mail` ‚Üí –ø–∏—Å—å–º–æ –∫–ª–∏–µ–Ω—Ç—É;
  - `back_to_mail_kand` ‚Üí –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–∏—Å—å–º—É –∫–∞–Ω–¥–∏–¥–∞—Ç—É;
  - `send_mail_to_candidate:*` ‚Üí –≤—ã–±–æ—Ä –∫–∞–Ω–∞–ª–∞ —Å–≤—è–∑–∏;
  - `con:*` ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ (Telegram/Email/Phone).
- –ü—Ä–æ—á–µ–µ: `back_to_menu`, `/phone`, `add_another_resume` –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏–∏.

============================================================
5) –í–∞–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Ñ–∞–π–ª—ã
============================================================
- `.env`: BOT_TOKEN, API_ID, API_HASH, PHONE_NUMBER, GROUP_ID, ADMIN_ID, CLIENT_CHANNEL, GEMINI_API_KEY –∏ –¥—Ä.
- `requirements.txt`: –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫ (aiogram, Telethon, SQLAlchemy, google-generativeai, gspread, docx/pdf/rtf –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –ø—Ä.).
- `creds.json`: —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Google –¥–ª—è Sheets.
- `channels.db`: SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
- –ü–∞–ø–∫–∏: `downloads/` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–µ–∑—é–º–µ.

============================================================
6) –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ –æ—à–∏–±–∫–∞–º
============================================================
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö Gemini/Google Sheets/SMTP/Telethon ‚Äî –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã try/except —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –∞–¥–º–∏–Ω–∞ (–≤ —Ä—è–¥–µ —Ñ—É–Ω–∫—Ü–∏–π) –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞–º–∏.
- –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü —Ä–µ–∑—é–º–µ –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤ (`periodic_cleanup_task`).
- –î—É–±–ª–∏–∫–∞—Ç—ã –∏ ¬´—Å—Ç–æ–ø¬ª-—Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∑–∞—á—ë—Ä–∫–Ω—É—Ç—ã–µ ID –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ entities.

–ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞.
